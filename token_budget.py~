import json
import os

BUDGET_FILE = "token_log.json"
MAX_TOKENS = 128000

if not os.path.exists(BUDGET_FILE):
    with open(BUDGET_FILE, "w") as f:
        json.dump({"used_tokens": 0}, f)

def check_token_limit(prompt):
    with open(BUDGET_FILE, "r") as f:
        data = json.load(f)
    if len(prompt.split()) + data["used_tokens"] > MAX_TOKENS:
        return False
    return True

def log_tokens(used):
    with open(BUDGET_FILE, "r") as f:
        data = json.load(f)
    data["used_tokens"] += used
    with open(BUDGET_FILE, "w") as f:
        json.dump(data, f)
